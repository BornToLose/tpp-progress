var __extends=this&&this.__extends||function(t,n){function e(){this.constructor=t}for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r]);t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)},TPP;!function(t){var n;!function(t){t[t.Weeks=0]="Weeks",t[t.Days=1]="Days",t[t.Hours=2]="Hours",t[t.Minutes=3]="Minutes"}(n=t.Scale||(t.Scale={}))}(TPP||(TPP={}));var Twitch;!function(t){function n(t,n){void 0===n&&(n=!0);var r=[],o=function(t){return t.videos.length&&(r=r.concat.apply(r,t.videos.map(function(t){return new i(t.recorded_at,t.length,t.url,"Twitch")})),n&&t._total)?e(t._links.next).then(o):r};return $.when(e("https://api.twitch.tv/kraken/channels/"+t+"/videos?broadcasts=true&limit=100").then(o),e("https://api.twitch.tv/kraken/channels/"+t+"/videos?limit=100").then(o))}function e(t){return $.get(t+(t.indexOf("?")>0?"&":"?")+"client_id="+r)}var r="l6ejgsj101ymei0f6v4a6nkjw9upml9",i=function(){function t(t,n,e,r){this.recorded_at=t,this.length=n,this.url=e,this.source=r,this.StartTime=new Date(t).valueOf()/1e3,this.EndTime=this.StartTime+n}return t}();t.Video=i,t.GetVideos=n}(Twitch||(Twitch={}));var TPP;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){function n(t){return t.filter(function(t){return 1e3*t.StartTime<=Date.now()})}function e(t){return t.Runs=n(t.Runs),t}function r(t){return t.map(e)}t.RemoveFutureRunsFromRuns=n,t.RemoveFutureRunsFromCollection=e,t.RemoveFutureRuns=r}(n=t.Filter||(t.Filter={}))}(n=t.Data||(t.Data={}))}(n=t.Transforms||(t.Transforms={}))}(TPP||(TPP={}));var TPP;!function(t){var n;!function(n){var e;!function(n){var e;!function(n){function e(n){return n.forEach(function(n){return n.Ongoing=1e3*n.StartTime<=Date.now()&&1e3*(t.Duration.parse(n.Duration,n.StartTime).TotalSeconds+n.StartTime)>Date.now()}),n}function r(t){return t.Runs=e(t.Runs),t}function i(t){return t.map(r)}n.MarkOngoingRunsInRuns=e,n.MarkOngoingRunsInCollection=r,n.MarkOngoingRuns=i}(e=n.Processing||(n.Processing={}))}(e=n.Data||(n.Data={}))}(n=t.Transforms||(t.Transforms={}))}(TPP||(TPP={}));var TPP;!function(t){var n=function(){function n(t,e,r,i,o){if(void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===o&&(o=0),this.days=e,this.hours=r,this.minutes=i,this.seconds=o,"string"==typeof t){var s=n.parse(t);this.days=s.days,this.hours=s.hours,this.minutes=s.minutes,this.seconds=s.seconds}else this.days+=7*t}return Object.defineProperty(n.prototype,"TotalSeconds",{get:function(){return this.seconds+60*this.minutes+60*this.hours*60+60*this.days*60*24},set:function(t){this.seconds=Math.floor(t%60),this.minutes=Math.floor(t/60)%60,this.hours=Math.floor(t/60/60)%24,this.days=Math.floor(t/60/60/24)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"TotalHours",{get:function(){return this.TotalSeconds/60/60},set:function(t){this.TotalSeconds=60*t*60},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"TotalDays",{get:function(){return this.TotalHours/24},set:function(t){this.TotalHours=24*t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"TotalWeeks",{get:function(){return this.TotalDays/7},set:function(t){this.TotalDays=7*t},enumerable:!0,configurable:!0}),n.prototype.TotalTime=function(n){switch(n){case t.Scale.Weeks:return this.TotalWeeks;case t.Scale.Hours:return this.TotalHours/4;case t.Scale.Minutes:return 6*this.TotalHours}return this.TotalDays},n.prototype.toString=function(n){return void 0===n&&(n=t.Scale.Days),(n==t.Scale.Minutes?60*(24*this.days+this.hours)+this.minutes:(n==t.Scale.Hours?24*this.days+this.hours:(n==t.Scale.Weeks?Math.floor(this.days/7)+"w "+this.days%7:this.days)+"d "+this.hours)+"h "+this.minutes)+"m"+(this.seconds?" "+this.seconds+"s":"")},n.parse=function(t,e){var r=new n(0,0,0,0);if(t){if(this.canParse(t))try{var i=this.parseReg.exec(t);return new n(parseInt(i[1])||0,parseInt(i[2])||0,parseInt(i[3])||0,parseInt(i[4])||0,parseInt(i[5])||0)}catch(t){}e&&(r.TotalSeconds=Date.parse(t)/1e3-e)}return r},n.canParse=function(t){return this.parseReg.test(t)},n}();n.parseReg=/^\s*(?:(\d*)w)?\s*(?:(\d*)d)?\s*(?:(\d*)h)?\s*(?:(\d*)m)?\s*(?:(\d*)s)?\s*$/i,t.Duration=n}(TPP||(TPP={}));var TPP;!function(t){var n;!function(t){var n=function(){function t(){this.OwnedDict={},this.HallOfFame=[]}return t}();t.RunSummaryBase=n;var e=function(){function t(){this.Summary=[],this.HallOfFame=[]}return t}();t.CollectionSummaryBase=e;var r=function(){function t(){this.Owners=[],this.HallOfFame=[]}return Object.defineProperty(t.prototype,"IsOwned",{get:function(){return this.Owners&&this.Owners.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FirstOwnedRun",{get:function(){return this.IsOwned?this.Owners[0].Run:{}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FirstCaughtDate",{get:function(){return!!this.IsOwned&&this.Owners[0].CaughtOn},enumerable:!0,configurable:!0}),t}();t.DexEntryBase=r;var i;!function(t){t[t["Pokédex Number"]=0]="Pokédex Number",t[t.Alphabetical=1]="Alphabetical",t[t["First Owned"]=2]="First Owned"}(i=t.DexSorting||(t.DexSorting={}));var o=function(){function t(){this.Entries=[]}return Object.defineProperty(t.prototype,"NoGlitchMon",{get:function(){return this.Entries.filter(function(t){return!(0==t.Number&&"MissingNo."==t.Pokemon)})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TotalOwned",{get:function(){return this.NoGlitchMon.filter(function(t){return t.IsOwned}).length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TotalInDex",{get:function(){return this.NoGlitchMon.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OwnedPercentage",{get:function(){return this.TotalOwned/this.TotalInDex*100},enumerable:!0,configurable:!0}),t.prototype.TotalOwnedBy=function(t){return this.NoGlitchMon.filter(function(n){return n.Owners.filter(function(n){return n.Run.RunName==t.RunName}).length>0}).length},t.prototype.SortDex=function(t){switch(void 0===t&&(t=0),t){case 0:case i[0]:default:this.Entries=this.Entries.sort(function(t,n){return t.Number-n.Number});break;case 1:case i[1]:this.Entries=this.Entries.sort(function(t,n){return t.Pokemon.localeCompare(n.Pokemon)});break;case 2:case i[2]:this.Entries=this.Entries.sort(function(t,n){return(t.FirstCaughtDate||Date.now())-(n.FirstCaughtDate||Date.now())})}},t.prototype.FilterDexToOwned=function(){this.Entries=this.Entries.filter(function(t){return t.IsOwned})},t.prototype.FilterDexToUnowned=function(){this.Entries=this.Entries.filter(function(t){return!t.IsOwned})},t.prototype.FilterDexRuns=function(t){var n=t.map(function(t){return"string"==typeof t?t.toLowerCase().trim():t});this.Entries=this.Entries.filter(function(t){return t.Owners.filter(function(t){return n.filter(function(n){return"string"==typeof n?t.Run.RunName.toLowerCase().indexOf(n)>=0:t.Run.RunName==n.RunName}).length>0}).length>0})},t.prototype.FilterDexPokemon=function(t){t=t.map(function(t){return t.toLowerCase().trim()}),this.Entries=this.Entries.filter(function(n){return t.indexOf(n.Pokemon.toLowerCase())>=0})},t.prototype.FilterDexToHallOfFame=function(){this.Entries=this.Entries.filter(function(t){return t.HallOfFame.length>0})},t}();t.GlobalDexBase=o}(n=t.Pokedex||(t.Pokedex={}))}(TPP||(TPP={}));var TPP;!function(t){var n;!function(n){var e;!function(n){var e=function(n){function e(t,e){var r=n.call(this)||this;return r.Run=t,t.Events.filter(function(t){return"Pokemon"==t.Group&&(e.indexOf(t.Name)>=0||e.indexOf(t.Class)>=0)}).length&&(r.FillOwnedDict(e),r.FillHallOfFame(e)),r}return __extends(e,n),e.prototype.FillOwnedDict=function(n){var e=this;this.InitOwnedDict(n),this.Run.Events.filter(function(t){return"Pokemon"==t.Group}).forEach(function(r){var i=t.Duration.parse(r.Time,e.Run.StartTime).TotalSeconds+e.Run.StartTime;e.AddOwnedPokemonIfRecognized(r.Name,i,n)||e.AddOwnedPokemonIfRecognized(r.Class,i,n)})},e.prototype.AddOwnedPokemonIfRecognized=function(t,n,e){return!(e.indexOf(t)<0)&&(this.OwnedDict[t]=this.OwnedDict[t]&&this.OwnedDict[t]<n?this.OwnedDict[t]:n,!0)},e.prototype.InitOwnedDict=function(t){var n=this;this.OwnedDict={},t.forEach(function(t){return n.OwnedDict[t]=!1})},e.prototype.FillHallOfFame=function(n){var e=this;this.Run.Events.filter(function(n){return n.Party&&t.Duration.parse(n.Time,e.Run.StartTime).TotalSeconds>=0}).forEach(function(r){return r.Party.forEach(function(i){var o=n.indexOf(i.Pokemon)>=0?i.Pokemon:n.indexOf(i.Class)>=0?i.Class:null;o&&e.HallOfFame.push({Pokemon:o,Ribbon:r.Image,RunName:e.Run.RunName,HostName:e.Run.HostName,Nickname:(i.Nickname||i.Pokemon).replace(/π/g,"ᴾk").replace(/µ/g,"ᴹn"),UnmodifiedNick:i.Nickname,PreviousNick:i.PreviousNick,Time:t.Duration.parse(r.Time,e.Run.StartTime).TotalSeconds+e.Run.StartTime})})})},e}(t.Pokedex.RunSummaryBase);n.RunSummary=e}(e=n.Pokedex||(n.Pokedex={}))}(n=t.Transforms||(t.Transforms={}))}(TPP||(TPP={}));var TPP;!function(t){var n;!function(n){var e;!function(n){var e=function(t){function e(e,r){var i=t.call(this)||this,o=[];return e.forEach(function(t){return t.Runs.forEach(function(t){return o.push(new n.RunSummary(t,r))})}),i.Summary=o.sort(function(t,n){return t.Run.StartTime-n.Run.StartTime}),i.FilterHoFToUniques(),i}return __extends(e,t),e.prototype.FilterHoFToUniques=function(){var t=this.Summary.map(function(t){return t.HallOfFame}).reduce(function(t,n){return t.concat(n)}).sort(function(t,n){return t.Time-n.Time});this.HallOfFame=t.filter(function(n){return t.filter(function(t){return t.HostName==n.HostName&&t.Pokemon==n.Pokemon&&(t.Nickname==n.Nickname||n.PreviousNick==t.UnmodifiedNick)}).shift()==n})},e}(t.Pokedex.CollectionSummaryBase);n.CollectionSummary=e}(e=n.Pokedex||(n.Pokedex={}))}(n=t.Transforms||(t.Transforms={}))}(TPP||(TPP={}));var TPP;!function(t){var n;!function(n){var e;!function(n){var e=function(t){function n(n,e,r){var i=t.call(this)||this;return i.Number=e,i.Pokemon=n,n&&(i.GatherPokemonFromRuns(r),i.GatherHallOfFameEntries(r)),i}return __extends(n,t),n.prototype.GatherPokemonFromRuns=function(t){var n=this;t.Summary.forEach(function(t){return t.OwnedDict[n.Pokemon]&&n.Owners.push({Run:t.Run,CaughtOn:t.OwnedDict[n.Pokemon]})}),this.Owners=this.Owners.sort(function(t,n){return t.CaughtOn-n.CaughtOn}),this.FilterRevisitsIfPreviouslyOwned()},n.prototype.FilterRevisitsIfPreviouslyOwned=function(){var t=this;this.Owners=this.Owners.filter(function(n){return!n.Run.Revisit||0==t.Owners.filter(function(t){return t.Run.RunName==n.Run.Revisit.Run}).length})},n.prototype.GatherHallOfFameEntries=function(t){var n=this;this.HallOfFame=t.HallOfFame.filter(function(t){return t.Pokemon==n.Pokemon}).sort(function(t,n){return t.Time-n.Time})},n}(t.Pokedex.DexEntryBase);n.DexEntry=e}(e=n.Pokedex||(n.Pokedex={}))}(n=t.Transforms||(t.Transforms={}))}(TPP||(TPP={}));var TPP;!function(t){var n;!function(t){var n;!function(t){function n(t,n){return void 0===n&&(n=r),t?t.map(function(t){return"string"==typeof t?t:n[t]}):n}function e(t,n){return void 0===n&&(n=r),n.slice(0,(t||n.length)+1)}var r="undefined"!=typeof window?((window||{}).Pokedex||{}).PokeList||[]:[];t.DexMerge=n,t.ClipNationalDex=e}(n=t.Pokedex||(t.Pokedex={}))}(n=t.Transforms||(t.Transforms={}))}(TPP||(TPP={}));var TPP;!function(t){var n;!function(n){var e;!function(n){var e=function(t){function e(e,r){var i=t.call(this)||this;return i.Entries=r.map(function(t,r){return new n.DexEntry(t,r,e)}).filter(function(t){return!!t.Pokemon}),i}return __extends(e,t),e}(t.Pokedex.GlobalDexBase);n.GlobalDex=e}(e=n.Pokedex||(n.Pokedex={}))}(n=t.Transforms||(t.Transforms={}))}(TPP||(TPP={}));var TPP;!function(t){var n;!function(t){function n(t){return t.Scraper&&"function"==typeof Scrape?Scrape(t).then(function(n){return t},function(n){return t}):$.when(t)}function e(t){return $.when.apply($,t.Runs.map(n)).then(function(n){return t},function(n){return t})}function r(t){return $.when.apply($,t.map(e)).then(function(n){return t},function(n){return t})}t.UpdateRunData=n,t.UpdateCollectionData=e,t.UpdateData=r}(n=t.Transforms||(t.Transforms={}))}(TPP||(TPP={}));