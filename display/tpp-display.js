function toggleSetting(e){var t=e.id;settings[t]=e.checked,localStorage.setItem("settings",JSON.stringify(settings)),$.when((baseSettings[t].extraAction||function(){})()).always(updatePage)}function toggleGroup(e){var t=e.id.split("-").pop(),n=e.checked;showGroups[t]=n,localStorage.setItem("showGroups",JSON.stringify(showGroups)),$("."+t.replace(/[^A-Z0-9]/gi,"")).toggleClass("hidden",!n),updatePage()}function SerializeQueryString(){return Object.keys(QueryString).filter(function(e){return QueryString[e]}).length?"?"+Object.keys(QueryString).filter(function(e){return QueryString[e]}).map(function(e){return e+("true"==QueryString[e]?"":"="+encodeURI(QueryString[e]))}).join("&"):""}function updateGroups(){if(groups&&groupList){var e=$find([groupList],"input").pop().map(function(e){return e.id.split("-").pop()})||[];Object.keys(groups).filter(function(t){return e.indexOf(t)<0}).forEach(function(e){var t=document.createElement("li"),n=document.createElement("input"),r=document.createElement("label");t.appendChild(n),t.appendChild(r),groupList.appendChild(t),n.type="checkbox",r.htmlFor=n.id="group-"+e,n.checked=showGroups[e]!==!1,r.innerText=groups[e],n.onchange=function(){return toggleGroup(n)}})}}function icon(e,t,n){var r=document.createElement("i");return r.classList.add("fa",e),r.title=t,n&&(r.onclick=n),r}function listControl(e,t){var n=document.createElement("li");n.appendChild(icon(e,t));var r=document.createElement("ul");return n.appendChild(r),{controlElement:n,listElement:r}}function qsListMenu(e,t,n,r,o,a){void 0===o&&(o="All"),void 0===a&&(a="");var i=listControl(e,t),s=QueryString[n];return QueryString[n]=null,r.forEach(function(e){var t=document.createElement("li"),r=document.createElement("a");e?r.innerText=r.innerHTML=a+(QueryString[n]=e):r.innerText=r.innerHTML=o,r.href=window.location.href.split("?").shift()+SerializeQueryString(),i.listElement.appendChild(t),t.appendChild(r),s==e&&t.classList.add("selected")}),QueryString[n]=s,i.controlElement}function qsOptionsMenu(e,t,n){var r=listControl(e,t);return Object.keys(n).forEach(function(e){var t=document.createElement("li"),o=document.createElement("a"),a=QueryString[e];QueryString[e]=a?null:"true",o.innerText=o.innerHTML=n[e],o.href=window.location.href.split("?").shift()+SerializeQueryString(),r.listElement.appendChild(t),t.appendChild(o),QueryString[e]=a,a&&t.classList.add("selected")}),r.controlElement}function zoomButtons(){var e=document.createElement("li"),t=document.createElement("li");return e.appendChild(icon("fa-search-plus","Zoom In",function(){return zoomIn()})),t.appendChild(icon("fa-search-minus","Zoom Out",function(){return zoomOut()})),[e,t]}function settingsMenu(){var e=listControl("fa-gear","Settings");return Object.keys(baseSettings).forEach(function(t){var n=document.createElement("li"),r=document.createElement("input");r.type="checkbox",r.id=t,r.checked=settings[t],r.onchange=function(){return toggleSetting(r)},n.appendChild(r);var o=document.createElement("label");o.htmlFor=r.id,o.innerText=o.innerHTML=baseSettings[t].displayName,n.appendChild(o),e.listElement.appendChild(n)}),e.controlElement.classList.add("settings"),e.controlElement}function groupsMenu(){var e=listControl("fa-eye","Groups");return groupList=e.listElement,e.controlElement.classList.add("groups"),updateGroups(),e.controlElement}function dayMenu(e){void 0===e&&(e=40);var t=0,n=parseInt(QueryString.day||"0")||0;Array.isArray(e)?e.forEach(function(e){return e.Runs.forEach(function(r){return t=Math.max(t,Math.ceil(TPP.Duration.parse(r.Duration,r.StartTime).TotalTime(e.Scale)+(e.Offset||0)+n))})}):t=e;var r=listControl("fa-calendar","Day"),o=document.createElement("li"),a=document.createElement("select");a.id="day";for(var i=0;i<t+1;i++){var s=document.createElement("option");i?s.value=s.innerText=s.innerHTML=i.toFixed(0):s.innerText=s.innerHTML="All",n==i&&(s.selected=!0),a.appendChild(s)}var u=document.createElement("label");return u.htmlFor=a.id,u.innerHTML="Day:&nbsp;",o.appendChild(u),o.appendChild(a),r.listElement.appendChild(o),a.onchange=function(){QueryString.day="All"==a.value?null:a.value,window.location.href=window.location.href.split("?").shift()+SerializeQueryString()},r.controlElement}function regionMenu(e){var t;if(e[0]&&e[0].Name){var n=e;t=[],n.forEach(function(e){e.Runs.forEach(function(e){e.Unfinished||(e.Region&&t.indexOf(e.Region)<0&&t.push(e.Region),(e.AdditionalRegions||[]).forEach(function(e){e.Name&&t.indexOf(e.Name)<0&&t.push(e.Name)}))})})}else t=e;return qsListMenu("fa-globe","Region","region",t)}function twitchButton(){var e=document.createElement("li");return e.appendChild(icon("fa-twitch","Twitch Videos",function(){return getTwitchVideos()})),e}function defaultControls(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=zoomButtons();return n.push(settingsMenu()),n.push(groupsMenu()),e.forEach(function(e){return n.push(e)}),n.push(twitchButton()),n}function drawControls(e,t){t=t||(document.currentScript||Array.prototype.concat.apply([],document.getElementsByTagName("script")).pop()).parentElement,e.forEach(function(e){t.appendChild(e),t.appendChild(document.createTextNode("\n"))})}var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},fakeQuery=function(e){return Array.prototype.slice.call(document.querySelectorAll(e))},$find=function(e,t){return e.map(function(e){return e?Array.prototype.slice.call(e.querySelectorAll(t)):[]})},updatePage=updatePage||function(){},reprocessCharts=reprocessCharts||function(){},baseSettings={explode:{displayName:"Stagger Clumps",defaultValue:!0},hideUnfinished:{displayName:"Hide Runs Left Unfinished",defaultValue:!0,extraAction:reprocessCharts}},settings=JSON.parse(localStorage.getItem("settings")||"{}");Object.keys(baseSettings).forEach(function(e){return settings[e]="boolean"==typeof settings[e]?settings[e]:baseSettings[e].defaultValue});var showGroups=JSON.parse(localStorage.getItem("showGroups")||"{}"),TPP;!function(e){var t;!function(e){e[e.Weeks=0]="Weeks",e[e.Days=1]="Days",e[e.Hours=2]="Hours",e[e.Minutes=3]="Minutes"}(t=e.Scale||(e.Scale={}))}(TPP||(TPP={}));var Twitch;!function(e){function t(e,t){void 0===t&&(t=!0);var r=[],a=function(e){return e.videos.length&&(r=r.concat.apply(r,e.videos.map(function(e){return new o(e.recorded_at,e.length,e.url,"Twitch")})),t&&e._total)?n(e._links.next).then(a):r};return $.when(n("https://api.twitch.tv/kraken/channels/"+e+"/videos?broadcasts=true&limit=100").then(a),n("https://api.twitch.tv/kraken/channels/"+e+"/videos?limit=100").then(a))}function n(e){return $.get(e+(e.indexOf("?")>0?"&":"?")+"client_id="+r)}var r="l6ejgsj101ymei0f6v4a6nkjw9upml9",o=function(){function e(e,t,n,r){this.recorded_at=e,this.length=t,this.url=n,this.source=r,this.StartTime=new Date(e).valueOf()/1e3,this.EndTime=this.StartTime+t}return e}();e.Video=o,e.GetVideos=t}(Twitch||(Twitch={}));var TPP;!function(e){var t=function(){function t(e,n,r,o,a){if(void 0===n&&(n=0),void 0===r&&(r=0),void 0===o&&(o=0),void 0===a&&(a=0),this.days=n,this.hours=r,this.minutes=o,this.seconds=a,"string"==typeof e){var i=t.parse(e);this.days=i.days,this.hours=i.hours,this.minutes=i.minutes,this.seconds=i.seconds}else this.days+=7*e}return Object.defineProperty(t.prototype,"TotalSeconds",{get:function(){return this.seconds+60*this.minutes+60*this.hours*60+60*this.days*60*24},set:function(e){this.seconds=Math.floor(e%60),this.minutes=Math.floor(e/60)%60,this.hours=Math.floor(e/60/60)%24,this.days=Math.floor(e/60/60/24)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TotalHours",{get:function(){return this.TotalSeconds/60/60},set:function(e){this.TotalSeconds=60*e*60},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TotalDays",{get:function(){return this.TotalHours/24},set:function(e){this.TotalHours=24*e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TotalWeeks",{get:function(){return this.TotalDays/7},set:function(e){this.TotalDays=7*e},enumerable:!0,configurable:!0}),t.prototype.TotalTime=function(t){switch(t){case e.Scale.Weeks:return this.TotalWeeks;case e.Scale.Hours:return this.TotalHours/4;case e.Scale.Minutes:return 6*this.TotalHours}return this.TotalDays},t.prototype.toString=function(t){return void 0===t&&(t=e.Scale.Days),(t==e.Scale.Minutes?60*(24*this.days+this.hours)+this.minutes:(t==e.Scale.Hours?24*this.days+this.hours:(t==e.Scale.Weeks?Math.floor(this.days/7)+"w "+this.days%7:this.days)+"d "+this.hours)+"h "+this.minutes)+"m"+(this.seconds?" "+this.seconds+"s":"")},t.parse=function(e,n){var r=new t(0,0,0,0);if(e){if(this.canParse(e))try{var o=this.parseReg.exec(e);return new t(parseInt(o[1])||0,parseInt(o[2])||0,parseInt(o[3])||0,parseInt(o[4])||0,parseInt(o[5])||0)}catch(e){}n&&(r.TotalSeconds=Date.parse(e)/1e3-n)}return r},t.canParse=function(e){return this.parseReg.test(e)},t}();t.parseReg=/^\s*(?:(\d*)w)?\s*(?:(\d*)d)?\s*(?:(\d*)h)?\s*(?:(\d*)m)?\s*(?:(\d*)s)?\s*$/i,e.Duration=t}(TPP||(TPP={}));var QueryString=function(){var e={};return window.location.search.substring(1).split("&").forEach(function(t){if(t.indexOf("=")>0){var n=t.split("=");e[n.shift()]=decodeURI(n.join("="))}else e[t]="true"}),e}(),TPP;!function(e){var t;!function(e){var t=function(){function e(){this.OwnedDict={},this.HallOfFame=[]}return e}();e.RunSummaryBase=t;var n=function(){function e(){this.Summary=[],this.HallOfFame=[]}return e}();e.CollectionSummaryBase=n;var r=function(){function e(){this.Owners=[],this.HallOfFame=[]}return Object.defineProperty(e.prototype,"IsOwned",{get:function(){return this.Owners&&this.Owners.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FirstOwnedRun",{get:function(){return this.IsOwned?this.Owners[0].Run:{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FirstCaughtDate",{get:function(){return!!this.IsOwned&&this.Owners[0].CaughtOn},enumerable:!0,configurable:!0}),e}();e.DexEntryBase=r;var o;!function(e){e[e["Pokédex Number"]=0]="Pokédex Number",e[e.Alphabetical=1]="Alphabetical",e[e["First Owned"]=2]="First Owned"}(o=e.DexSorting||(e.DexSorting={}));var a=function(){function e(){this.Entries=[],this.isGlitchMon=function(e){return 0==e.Number&&"MissingNo."==e.Pokemon}}return Object.defineProperty(e.prototype,"NoGlitchMon",{get:function(){var e=this;return this.Entries.filter(function(t){return!e.isGlitchMon(t)})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalOwned",{get:function(){return this.NoGlitchMon.filter(function(e){return e.IsOwned}).length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalInDex",{get:function(){return this.NoGlitchMon.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OwnedPercentage",{get:function(){return this.TotalOwned/this.TotalInDex*100},enumerable:!0,configurable:!0}),e.prototype.TotalOwnedBy=function(e){return this.NoGlitchMon.filter(function(t){return t.Owners.filter(function(t){return t.Run.RunName==e.RunName}).length>0}).length},Object.defineProperty(e.prototype,"Owned",{get:function(){return this.Entries.filter(function(e){return e.IsOwned})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Unowned",{get:function(){return this.Entries.filter(function(e){return!e.IsOwned})},enumerable:!0,configurable:!0}),e.prototype.SortDex=function(e){switch(void 0===e&&(e=0),e){case 0:case o[0]:default:this.Entries=this.Entries.sort(function(e,t){return e.Number-t.Number});break;case 1:case o[1]:this.Entries=this.Entries.sort(function(e,t){return e.Pokemon.localeCompare(t.Pokemon)});break;case 2:case o[2]:this.Entries=this.Entries.sort(function(e,t){return(e.FirstCaughtDate||Date.now())-(t.FirstCaughtDate||Date.now())})}},e.prototype.FilterGlitchMon=function(){this.Entries=this.NoGlitchMon},e.prototype.FilterUnownedGlitchMon=function(){var e=this;this.Entries=this.Entries.filter(function(t){return t.IsOwned||!e.isGlitchMon(t)})},e.prototype.FilterOwnedInDexToRuns=function(e){Array.isArray(e)||(e=e.split(","));var t=e.map(function(e){return"string"==typeof e?e.toLowerCase().trim():e}),n=function(e){return e.Owners.filter(function(e){return t.filter(function(t){return"string"==typeof t?e.Run.RunName.toLowerCase().indexOf(t)>=0:e.Run.RunName==t.RunName}).length>0}).length>0};this.Entries.forEach(function(e){return e.Owners=n(e)?e.Owners:[]})},e.prototype.FilterDexToOwned=function(){this.Entries=this.Owned},e.prototype.FilterDexToUnowned=function(){this.Entries=this.Unowned},e.prototype.FilterDexPokemon=function(e){Array.isArray(e)||(e=e.split(",")),e=e.map(function(e){return e.toLowerCase().trim()}),this.Entries=this.Entries.filter(function(t){return e.indexOf(t.Pokemon.toLowerCase())>=0})},e.prototype.FilterDexToHallOfFame=function(){this.Entries=this.Entries.filter(function(e){return e.HallOfFame.length>0})},e}();e.GlobalDexBase=a}(t=e.Pokedex||(e.Pokedex={}))}(TPP||(TPP={}));var groupList,groups,zoomIn=zoomIn||function(){},zoomOut=zoomOut||zoomIn,pokedexGenerationsMenu=function(){return qsListMenu("fa-gamepad","Generations","g",Pokedex.GenSlice.map(function(e,t){return t?t.toFixed(0):null}),"All","Generation ")},pokedexRegionsMenu=function(){return qsListMenu("fa-globe","Region","dex",Object.keys(Pokedex.Regional).map(function(e,t){return t?e:null}),"National")},pokedexSortMenu=function(){return qsListMenu("fa-sort","Sort","sort",Object.keys(TPP.Pokedex.DexSorting).filter(function(e){return!isNaN(e)}).map(function(e){return parseInt(e)?TPP.Pokedex.DexSorting[e]:null}),TPP.Pokedex.DexSorting[0])},getTwitchVideos=getTwitchVideos||function(){},TPP;!function(e){var t;!function(e){e.cleanString=function(e){return e.replace(/[^A-Z0-9]/gi,"").toLowerCase()}}(t=e.Display||(e.Display={}))}(TPP||(TPP={}));var TPP;!function(e){var t;!function(e){var t;!function(e){var t=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){return React.createElement("div",{className:"pokeBorder"},React.createElement("div",{className:"border"}),React.createElement("div",{className:"border"}),React.createElement("div",null," ",this.props.children," "))},t}(React.Component);e.PokeBox=t}(t=e.Elements||(e.Elements={}))}(t=e.Display||(e.Display={}))}(TPP||(TPP={}));var TPP;!function(e){var t;!function(e){var t;!function(t){var n;!function(t){var n=function(t){function n(e){var n=t.call(this,e)||this;n.entry=e.entry,n.showOwnership=!!e.showOwnership;var r=n.entry.Number.toString();return n.Number=("000"+r).substring(r.length),n}return __extends(n,t),Object.defineProperty(n.prototype,"className",{get:function(){return("dexEntry "+(!this.showOwnership||this.entry.IsOwned?"owned":"")).trim()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pokeName",{get:function(){return e.cleanString(this.entry.Pokemon)||"unidentified"},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"owners",{get:function(){return this.entry.IsOwned?"Owned by:\n"+this.entry.Owners.map(function(e){return e.Run.HostName+" ("+e.Run.RunName+")"}).join("\n"):"Didn't Catch"},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){var e={};return this.showOwnership&&this.entry.IsOwned&&(e.backgroundColor=this.entry.Owners[0].Run.ColorPrimary),e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hallOfFame",{get:function(){if(!this.showOwnership)return null;var e=this.entry.HallOfFame;return e.length?React.createElement("div",{className:"hofRibbon"},e.map(function(e){var t=e.HostName+"'s "+e.Nickname+" ("+e.RunName+")";return React.createElement("img",{key:t,src:e.Ribbon,alt:t,title:t})})):null},enumerable:!0,configurable:!0}),n.prototype.render=function(){return React.createElement("div",{key:this.Number,className:this.className,style:this.style,title:this.showOwnership?this.owners:null},React.createElement("h3",null,this.Number),React.createElement("h4",null,this.entry.Pokemon),this.props.children,React.createElement("div",{className:"pokesprite "+this.pokeName},React.createElement("img",{src:"img/missingno.png"})),this.hallOfFame)},n}(React.Component);t.DexEntry=n}(n=t.Pokedex||(t.Pokedex={}))}(t=e.Elements||(e.Elements={}))}(t=e.Display||(e.Display={}))}(TPP||(TPP={}));var TPP;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(t){function n(e){var n=t.call(this,e)||this;return n.dex=e.dex,n.showOwnership=e.showOwnership!==!1,n.ownedOnly=e.ownedOnly,n.showOwnership?n.dex.FilterUnownedGlitchMon():n.dex.FilterGlitchMon(),n}return __extends(n,t),Object.defineProperty(n.prototype,"className",{get:function(){return("pokedex "+(this.props.className||"")).trim()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"entries",{get:function(){var t=this;return(this.ownedOnly?this.dex.Owned:this.dex.Entries).map(function(n){return React.createElement(e.DexEntry,{key:n.Number,entry:n,showOwnership:t.showOwnership})})},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ownedDisplay",{get:function(){return this.showOwnership?React.createElement("h2",{className:"total"},"Owned: ",React.createElement("span",null,this.dex.TotalOwned+"/"+this.dex.TotalInDex+" ("+this.dex.OwnedPercentage.toFixed(2)+"%)")):React.createElement("br",null)},enumerable:!0,configurable:!0}),n.prototype.render=function(){return React.createElement("div",{className:this.className},this.ownedDisplay,this.entries,this.props.children)},n}(React.Component);e.Dex=t}(t=e.Pokedex||(e.Pokedex={}))}(t=e.Elements||(e.Elements={}))}(t=e.Display||(e.Display={}))}(TPP||(TPP={}));var TPP;!function(e){var t;!function(e){var t;!function(t){function n(e){return $("<h2 class='total'>Owned: <span>"+e.TotalOwned+"/"+e.TotalInDex+" ("+e.OwnedPercentage.toFixed(2)+"%)</span></h2>")}function r(t,n){void 0===n&&(n=!0);var r=t.Number.toString(),o=("000"+r).substring(r.length),a=e.cleanString(t.Pokemon)||"unidentified",i=$("<div class='dexEntry'>").append("<h3>"+o+"</h3>").append("<h4>"+t.Pokemon+"</h4>").append("<div class='pokesprite "+a+"'><img src='img/missingno.png'></div>");if(n){var s=t.HallOfFame;if(s.length){var u=$("<div>").addClass("hofRibbon").appendTo(i);s.forEach(function(e){var t=e.HostName+"'s "+e.Nickname+" ("+e.RunName+")";u.append($("<img>").attr("src",e.Ribbon).attr("alt",t).attr("title",t))})}t.IsOwned?i.addClass("owned").attr("title","Owned by:\n"+t.Owners.map(function(e){return e.Run.HostName+" ("+e.Run.RunName+")"}).join("\n")).css("background-color",t.Owners[0].Run.ColorPrimary):i.attr("title","Didn't Catch")}else i.addClass("owned");return i}function o(e,t){void 0===t&&(t=!0);var o=$("<div class='pokedex'>");return o.append(n(e)),o.append(e.Entries.map(function(e){return r(e,t)})),o}t.DrawOwnedCount=n,t.DrawDexEntry=r,t.DrawPokedex=o}(t=e.Pokedex||(e.Pokedex={}))}(t=e.Display||(e.Display={}))}(TPP||(TPP={}));var TPP;!function(e){var t;!function(t){var n;!function(n){function r(){return $.get("https://twitchplayspokemon.tv/api/run_status")}function o(e){return e.filter(function(e){return 0==e.Name.indexOf("Season")}).map(function(e){return e.Runs[e.Runs.length-1]}).pop()}function a(e,t){return t=t.trim(),e.map(function(e){return e.Runs.filter(function(e){return e.RunName==t}).shift()}).filter(function(e){return!!e}).shift()||e.map(function(e){return e.Runs.filter(function(e){return e.RunName.indexOf(t)>=0}).shift()}).filter(function(e){return!!e}).shift()||o(e)}function i(e){return $.get("http://thatswhatyouget.github.io/tpp-progress/bin/tpp-data.json").then(function(t){for(var n=0;n<e.length;n++)for(var r=0;r<e[n].Runs.length;r++)e[n].Runs[r].Events=t[n].Runs[r].Events;return e},function(t){return e})}function s(e){return e=e.replace(/'l/gi,"|"),e=e.replace(/'m/gi,"~"),e=e.replace(/'r/gi,"%"),e=e.replace(/'s/gi,"&"),e=e.replace(/'t/gi,"}"),e=e.replace(/'v/gi,"@"),e=e.replace(/#/gi,"#.")}function u(e,t){void 0===t&&(t=null);var n=$("<div>");return n.append($("<i class='fa fa-spinner fa-pulse'>")),e.Ongoing?r().then(function(r){return d(e,t,r,n)},function(e){n.children().remove(),n.append($("<h1 class='error'>").text("Run Status is not currently available."))}):d(e,t,{},n),n}function l(e,t,n,o){void 0===o&&(o=function(){return null}),t.find("h1").first().css("position","relative").append($('<i class="fa fa-refresh fa-spin">').css({position:"absolute",right:"1em"}));var a=r();return i(n).then(function(r){return a.then(function(r){return d(e,o(n),r,t)},function(e){t.find(".fa-refresh").remove(),console.log("Could not update run status.")})})}function d(n,r,o,a){if(n.Duration=(new Date).toISOString(),a.children().remove(),a.append($("<h1>").text(n.RunName)),o.party?a.append(T(n,o)):n.Events.filter(function(e){return e.Party}).length>0&&a.append(w(n,n.Events.filter(function(e){return e.Party}).pop())),o.map_id&&a.append(v(n,o)),g(n).length>0&&a.append(C(n,g(n))),m(n).length>0&&a.append(C(n,m(n))),y(n).length>0&&a.append(C(n,y(n))),f(n).length>0&&a.append(C(n,f(n))),h(n).length>0&&a.append(C(n)),o.items&&a.append(p(o.items,void 0,k[n.BaseGame],b[n.BaseGame])),o.pc_items&&a.append(p(o.pc_items,n.HostName+"'s PC",k[n.BaseGame],b[n.BaseGame])),r&&r.TotalOwnedBy(n)>0){var i=r.Entries.filter(function(e){return e.Owners.filter(function(e){return e.Run==n}).length>0});r.Entries=r.Entries.map(function(e){return i.indexOf(e)<0&&(e.Owners=[]),e}),a.append(c().addClass("pokedex").addClass(t.cleanString(n.RunName)).append(S()).append($("<h3>").text("Pokédex")).append(i.length<o.caught?$("<h6>").text("(Outdated)"):"").append(e.Display.Pokedex.DrawOwnedCount(r)).append(i.map(function(t){return e.Display.Pokedex.DrawDexEntry(t)})).append($("<a>").addClass("plug").attr("href","pokedex.html").text("See Global Pokédex")))}}function c(){return $("<div>").addClass("pokeBorder").append($("<div class='border'>")).append($("<div class='border'>"))}function p(e,t,n,r){void 0===t&&(t="Items"),void 0===n&&(n={}),void 0===r&&(r=[]),e=e||[];var o=c().addClass("itemsList");o.append(S()),o.append($("<h3>").text(s(t+" ("+e.length+")")));var a=$("<ul>").appendTo(o);return e.map(function(e){return r.indexOf(e.name.toUpperCase())>=0&&e.count<2&&(e.count=null),n[e.name.toUpperCase()]&&(e.name+=" "+n[e.name.toUpperCase()]),e}).forEach(function(e){return a.append($("<li>").text(s(e.name)).attr("data-quantity",e.count))}),o}function h(e){return e.Events.filter(function(e){return"Badges"==e.Group||"Bosses"==e.Group||"Kingdoms"==e.Group})}function f(e){return e.Events.filter(function(e){return"Elite Four"==e.Group||"Final Bosses"==e.Group||"Champions"==e.Group&&e.Image.indexOf("rematch")<0&&e.Image.indexOf("hosts")<0})}function m(e){return e.Events.filter(function(e){return"Elite Four Rematch"==e.Group||"Champions"==e.Group&&e.Image.indexOf("rematch")>0})}function g(e){return e.Events.filter(function(e){return"Past Hosts"==e.Group||"Champions"==e.Group&&e.Image.indexOf("hosts")>0})}function y(e){return e.Events.filter(function(e){return"Rematch Badges"==e.Group})}function C(t,n){void 0===n&&(n=h(t));var r=c().addClass("badgeList");r.append(S()),r.append($("<h3>").text(s(n[0].Group)));var o=$("<ul>").appendTo(r);return n.forEach(function(n){var r=$("<li>").appendTo(o);r.append($("<h3>").text(n.Name)),r.append($("<img>").attr("src",n.Image)),r.append($("<h4>").text(e.Duration.parse(n.Time,t.StartTime).toString(e.Scale.Days).replace(/m.*/,"m"))),n.Attempts&&r.append($("<h5>").text(n.Attempts.toString()+" Attempt"+(n.Attempts>1?"s":"")))}),r}function v(e,t){var n=$("<div class='location'>");return R[e.BaseGame]&&"number"==typeof t.map_id&&n.append($("<h2>").text("Current Location: "+R[e.BaseGame][t.map_id])),n}function P(e){switch(e){case 1:return"SLP";case 2:return"FRZ";case 4:return"BRN";case 8:return"PSN";case 32:return"PSN";case 64:return"PAR"}return""}function S(){return $("<i>").addClass("fa fa-window-restore window-shade").click(function(){$(this).parent().children("*:not(h1,h2,h3,h4,h5,h6,.border,.window-shade)").slideToggle()})}function T(n,r){var o=c().addClass("hallOfFameDisplay");o.append(S()),o.addClass(t.cleanString(n.RunName)+" "+(n.Class||"")+" "+(n.BaseGame||"")),o.append($("<h3>").text("Current Party")),o.append($("<h4>").text(e.Duration.parse(n.Duration,n.StartTime).toString(e.Scale.Days)));var a=$("<tr>").appendTo($("<table>").appendTo(o)),i=$("<div class='entry host'>").appendTo($("<td>").appendTo(a)),s=$("<img>").attr("src",n.HostImage).attr("alt",n.HostName).attr("title",n.HostName);n.HostImageSource&&(s=$("<a>").attr("href",n.HostImageSource).append(s)),i.append(s);var u=$('<div class="info">').append($('<div class="name">').text(n.HostName)).appendTo(i);if(r.money&&u.append($('<div data-entry="Money">').text("$"+r.money.toString())),r.coins&&u.append($('<div data-entry="Coins">').text(r.coins.toString())),r.badges){var l=r.badges.toString(2).match(/1/g).length;u.append($('<div data-entry="Badges">').text(l))}r.caught&&u.append($('<div data-entry="Owned">').text(r.caught.toString())),r.seen&&u.append($('<div data-entry="Seen">').text(r.seen.toString())),r.party.forEach(function(e){var n=(e.name||e.species.name).replace(/\s/g,"&nbsp;").replace(/Ë/g,"µ").replace(/Ê/g,"π"),r=$("<div class='entry'>");e.health&&!e.health[0]?r.addClass("fainted"):r.addClass(P(e.status)),r.append($("<span class='level'>").text(e.level)),r.append($("<div class='pokesprite'><img src='img/missingno.png'/></div>").addClass(t.cleanString(e.species.name)).attr("title",e.species.name));var o=$("<div class='info'>").append($("<div class='name'>").html(n)).appendTo(r);if(e.species.id){var i=e.species.id.toString(),s=("000"+i).substring(i.length);o.append($("<div data-entry='"+s+"'>").text(e.species.name))}(e.moves||[]).forEach(function(e,t){return o.append($("<div data-entry='Move "+(t+1).toString()+"'>").text(e.name))}),a.append($("<td>").append(r))});for(var d=r.party.length;d<6;d++)$("<div class='entry'>").appendTo($("<td>").appendTo(a));return o.get(0)}function w(n,r,o){void 0===o&&(o=e.Scale.Days);var a=c().addClass("hallOfFameDisplay");a.append(S()),a.addClass(t.cleanString(n.RunName)+" "+(n.Class||"")+" "+(n.BaseGame||""));var i=new Date(1e3*(e.Duration.parse(r.Time,n.StartTime).TotalSeconds+n.StartTime));a.append($("<h3>").text(s(r.Name+" - "+i.toLocaleDateString()))),a.append($("<h4>").text(e.Duration.parse(r.Time,n.StartTime).toString(o))),r.Attempts&&a.append($("<h5>").text(r.Attempts+" Attempts")),a.append($("<img>").attr("src",r.Image));var u=$("<tr>").appendTo($("<table>").appendTo(a)),l=$("<div class='entry host'>").appendTo($("<td>").appendTo(u)),d=$("<img>").attr("src",n.HostImage).attr("alt",n.HostName).attr("title",n.HostName);n.HostImageSource&&(d=$("<a>").attr("href",n.HostImageSource).append(d)),l.append(d);var p=$('<div class="info">').append($('<div class="name">').text(n.HostName)).appendTo(l);r.IDNo&&p.append($('<div data-entry="IDNo">').text(r.IDNo)),r.Party.forEach(function(e){var n=(e.Nickname||e.Pokemon).replace(/\s/g,"&nbsp;"),r=$("<div class='entry'>").addClass((e.Gender||"").toLowerCase());r.append($("<span class='level'>").text(e.Level)),r.append($("<div class='pokesprite'><img src='img/missingno.png'/></div>").addClass(t.cleanString(e.Pokemon)).addClass(e.Shiny?"shiny":"").addClass((e.Gender||"").toLowerCase()).addClass(e.Class).addClass(t.cleanString(e.Form||"")).attr("title",e.Pokemon));var o=$("<div class='info'>").append($("<div class='name'>").html(n)).appendTo(r);if(e.Number){var a=e.Number.toString(),i=("000"+a).substring(a.length);o.append($("<div data-entry='"+i+"'>").text(e.Pokemon))}e.Met&&o.append($("<div data-entry='Met'>").text(e.Met)),e.Type1&&o.append($("<div data-entry='Type 1'>").text(e.Type1)),e.Type2&&o.append($("<div data-entry='Type 2'>").text(e.Type2)),e.OT&&o.append($("<div data-entry='OT'>").text(e.OT)),e.IDNo&&o.append($("<div data-entry='IDNo'>").text(e.IDNo)),u.append($("<td>").append(r))});for(var h=r.Party.length;h<6;h++)$("<div class='entry'>").appendTo($("<td>").appendTo(u));return a.get(0)}var R={},k={},b={};R.Red=R.Blue=R.Yellow=["Pallet Town","Viridian City","Pewter City","Cerulean City","Lavender Town","Vermilion City","Celadon City","Fuchsia City","Cinnabar Island","Pokémon League","Saffron City","Unused Fly location","Route 1","Route 2","Route 3","Route 4","Route 5","Route 6","Route 7","Route 8","Route 9","Route 10","Route 11","Route 12","Route 13","Route 14","Route 15","Route 16","Route 17","Route 18","Sea Route 19","Sea Route 20","Sea Route 21","Route 22","Route 23","Route 24","Route 25","Red's house (first floor)","Red's house (second floor)","Blue's house","Professor Oak's Lab","Pokémon Center (Viridian City)","Poké Mart (Viridian City)","School (Viridian City)","House 1 (Viridian City)","Pokémon Gym (Viridian City)","Diglett's Cave (Route 2 entrance)","Gate (Viridian City/Pewter City) (Route 2)","Oak's Aide House 1 (Route 2)","Gate (Route 2)","Gate (Route 2/Viridian Forest) (Route 2)","Viridian Forest","Pewter Museum (floor 1)","Pewter Museum (floor 2)","Pokémon Gym (Pewter City)","House with disobedient Nidoran♂ (Pewter City)","Poké Mart (Pewter City)","House with two Trainers (Pewter City)","Pokémon Center (Pewter City)","Mt. Moon (Route 3 entrance)","Mt. Moon","Mt. Moon","Invaded house (Cerulean City)","Poliwhirl for Jynx trade house (Red/Blue)Bulbasaur adoption house (Pokémon Yellow)","Pokémon Center (Cerulean City)","Pokémon Gym (Cerulean City)","Bike Shop (Cerulean City)","Poké Mart (Cerulean City)","Pokémon Center (Route 4)","Invaded house - alternative music (Cerulean City)","Saffron City Gate (Route 5)","Entrance to Underground Path (Kanto Routes 5-6) (Route 5)","Daycare Center (Route 5)","Saffron City Gate (Route 6)","Entrance to Underground Path (Route 6)","Entrance to Underground Path 2 (Route 6)","Saffron City Gate (Route 7)","Entrance to Underground Path (Route 7)","Entrance to Underground Path 2 (Route 7)","Saffron City Gate (Route 8)","Entrance to Underground Path (Route 8)","Pokémon Center (Rock Tunnel)","Rock Tunnel","Power Plant","Gate 1F (Route 11-Route 12)","Diglett's Cave (Vermilion City entrance)","Gate 2F (Route 11-Route 12)","Gate (Route 12-Route 13)","Sea Cottage","Pokémon Center (Vermilion City)","Pokémon Fan Club (Vermilion City)","Poké Mart (Vermilion City)","Pokémon Gym (Vermilion City)","House with Pidgey (Vermilion City)","Vermilion Harbor (Vermilion City)","S.S. Anne 1F","S.S. Anne 2F","S.S. Anne 3F","S.S. Anne B1F","S.S. Anne (Deck)","S.S. Anne (Kitchen)","S.S. Anne (Captain's room)","S.S. Anne 1F (Gentleman's room)","S.S. Anne 2F (Gentleman's room)","S.S. Anne B1F (Sailor/Fisherman's room)","Unused (Victory Road)","Unused (Victory Road)","Unused (Victory Road)","Victory Road (Route 23 entrance)","Unused (Pokémon League)","Unused (Pokémon League)","Unused (Pokémon League)","Unused (Pokémon League)","Lance's Elite Four room","Unused (Pokémon League)","Unused (Pokémon League)","Unused (Pokémon League)","Unused (Pokémon League)","Hall of Fame","Underground Path (Route 5-Route 6)","Blue's room","Underground Path (Route 7-Route 8)","Celadon Department Store 1F","Celadon Department Store 2F","Celadon Department Store 3F","Celadon Department Store 4F","Celadon Department Store Rooftop Square","Celadon Department Store Lift","Celadon Mansion 1F","Celadon Mansion 2F","Celadon Mansion 3F","Celadon Mansion 4F","Celadon Mansion 4F (Eevee building)","Pokémon Center (Celadon City)","Pokémon Gym (Celadon City)","Rocket Game Corner (Celadon City)","Celadon Department Store 5F","Prize corner (Celadon City)","Restaurant (Celadon City)","House with Team Rocket members (Celadon City)","Hotel (Celadon City)","Pokémon Center (Lavender Town)","Pokémon Tower F1","Pokémon Tower F2","Pokémon Tower F3","Pokémon Tower F4","Pokémon Tower F5","Pokémon Tower F6","Pokémon Tower F7","Mr. Fuji's house (Lavender Town)","Poké Mart (Lavender Town)","House with NPC discussing Cubone's mother","Poké Mart (Fuchsia City)","House with NPCs discussing Bill (Fuchsia City)","Pokémon Center (Fuchsia City)","Warden's house (Fuchsia City)","Safari Zone gate (Fuchsia City)","Pokémon Gym (Fuchsia City)","House with NPCs discussing Baoba (Fuchsia City)","Seafoam Islands","Seafoam Islands","Seafoam Islands","Seafoam Islands","Vermilion City Fishing Brother","Fuchsia City Fishing Brother","Pokémon Mansion (1F)","Pokémon Gym (Cinnabar Island)","Pokémon Lab (Cinnabar Island)","Pokémon Lab - Trade room (Cinnabar Island)","Pokémon Lab - Room with scientists (Cinnabar Island)","Pokémon Lab - Fossil resurrection room (Cinnabar Island)","Pokémon Center (Cinnabar Island)","Poké Mart (Cinnabar Island)","Poké Mart - alternative music (Cinnabar Island)","Pokémon Center (Indigo Plateau)","Copycat's house 1F (Saffron City)","Copycat's house 2F (Saffron City)","Fighting Dojo (Saffron City)","Pokémon Gym (Saffron City)","House with Pidgey (Saffron City)","Poké Mart (Saffron City)","Silph Co. 1F","Pokémon Center (Saffron City)","Mr. Psychic's house (Saffron City)","Gate 1F (Route 15)","Gate 2F (Route 15)","Gate 1F (Cycling Road (Route 16)","Gate 2F (Cycling Road (Route 16)","Secret house (Cycling Road) (Route 16)","Route 12 Fishing Brother","Gate 1F (Route 18)","Gate 2F (Route 18)","Seafoam Islands","Badges check gate (Route 22)","Victory Road","Gate 2F (Route 12)","House with NPC and HM moves advice Vermilion City","Diglett's Cave","Victory Road","Team Rocket Hideout (B1F)","Team Rocket Hideout (B2F)","Team Rocket Hideout (B3F)","Team Rocket Hideout (B4F)","Team Rocket Hideout (Lift)","Unused (Team Rocket Hideout)","Unused (Team Rocket Hideout)","Unused (Team Rocket Hideout)","Silph Co. (2F)","Silph Co. (3F)","Silph Co. (4F)","Silph Co. (5F)","Silph Co. (6F)","Silph Co. (7F)","Silph Co. (8F)","Pokémon Mansion (2F)","Pokémon Mansion (3F)","Pokémon Mansion (B1F)","Safari Zone (Area 1)","Safari Zone (Area 2)","Safari Zone (Area 3)","Safari Zone (Entrance)","Safari Zone (Rest house 1)","Safari Zone (Prize house)","Safari Zone (Rest house 2)","Safari Zone (Rest house 3)","Safari Zone (Rest house 4)","Unknown Dungeon","Unknown Dungeon 1F","Unknown Dungeon B1F","Name Rater's house (Lavender Town)","Cerulean City (Gym Badge man)","Unused (Rock Tunnel)","Rock Tunnel","Silph Co. 9F","Silph Co. 10F","Silph Co. 11F","Silph Co. Lift","(Invalid)","(Invalid)","Cable Club Trade Center(*)","Cable Club Colosseum(*)","(Invalid)","(Invalid)","(Invalid)","(Invalid)","Lorelei's room","Bruno's room","Agatha's room","Summer Beach House (Pokémon Yellow)","(Invalid)","(Invalid)","(Invalid)","(Invalid)","(Invalid)","(Invalid)","?"],
k.Red=k.Blue=k.Yellow={TM01:"Mega Punch",TM02:"Razor Wind",TM03:"Swords Dance",TM04:"Whirlwind",TM05:"Mega Kick",TM06:"Toxic",TM07:"Horn Drill",TM08:"Body Slam",TM09:"Take Down",TM10:"Double-Edge",TM11:"BubbleBeam",TM12:"Water Gun",TM13:"Ice Beam",TM14:"Blizzard",TM15:"Hyper Beam",TM16:"Pay Day",TM17:"Submission",TM18:"Counter",TM19:"Seismic Toss",TM20:"Rage",TM21:"Mega Drain",TM22:"SolarBeam",TM23:"Dragon Rage",TM24:"Thunderbolt",TM25:"Thunder",TM26:"Earthquake",TM27:"Fissure",TM28:"Dig",TM29:"Psychic",TM30:"Teleport",TM31:"Mimic",TM32:"Double Team",TM33:"Reflect",TM34:"Bide",TM35:"Metronome",TM36:"Selfdestruct",TM37:"Egg Bomb",TM38:"Fire Blast",TM39:"Swift",TM40:"Skull Bash",TM41:"Softboiled",TM42:"Dream Eater",TM43:"Sky Attack",TM44:"Rest",TM45:"Thunder Wave",TM46:"Psywave",TM47:"Explosion",TM48:"Rock Slide",TM49:"Tri Attack",TM50:"Substitute",HM01:"Cut",HM02:"Fly",HM03:"Surf",HM04:"Strength",HM05:"Flash"},b.Red=b.Blue=b.Yellow=["Bicycle","Bike Voucher","Card Key","Coin Case","Dome Fossil","Gold Teeth","Good Rod","Helix Fossil","Itemfinder","Lift Key","Oak's Parcel","Old Amber","Old Rod","Poké Flute","Secret Key","Silph Scope","S.S.Ticket","Super Rod","Town Map","HM01","HM02","HM03","HM04","HM05"].map(function(e){return e.toUpperCase()}),n.GetCurrentRun=o,n.GetSpecifiedRun=a,n.RenderRunStatus=u,n.UpdateRunStatus=l}(n=t.RunStatus||(t.RunStatus={}))}(t=e.Display||(e.Display={}))}(TPP||(TPP={}));